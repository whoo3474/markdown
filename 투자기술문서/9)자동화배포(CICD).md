# CI/CD란?
CI는 Continuous Integration(지속적 통합), CD는 Continuous Delivery(지속적 전달)의 줄임말이다.

- CI : 테스트, 빌드, Dockerizing, 저장소에 전달하는 것까지 프로덕션 환경으로 서비스를 배포할 수 있도록 준비하는 프로세스
- CD : 저장소로 전달된 프로덕션 서비스를 실제 사용자들에게 배포하는 프로세스

작업한 소스 코드를 빌드하고, 저장소에 전달 후 배포까지 하는 과정을 통상적으로 CI/CD라고 부른다.

# GitOps
GitOps는 인프라 구성을 위해 Git을 버전 제어 시스템으로 사용하는 코드형 인프라(IaC)가 진화한 것이라고 생각하면 됩니다.
IaC는 원하는 시스템 상태를 정의하고 시스템의 실제 상태를 추적하여 인프라 관리에 대한 선언적 접근 방식을 따르는 경우가 많습니다.

IaC로 관리되기때문에, 시간의 흐름에따른 버전관리가 가능하다.
그렇기에 모든 버전에따른 롤백이 가능하다.
빌드 테스트, 배포등을 순차적으로 진행이 가능하다.
여러 운영체제(windows, linux, macos) 및 런타임 버전(nodejs, java ...등)에서 동시 테스트가 가능하다.


# ArgoCD
ArgoCD는 Kubernetes를 위한 선언적인 GitOps 지속적 전달 도구이다.
![image](https://user-images.githubusercontent.com/23617635/150494196-1a522ccb-fab3-4809-8967-a27b877d21a7.png)


# 구조
Arco CD는 실행 중인 애플리케이션을 지속적으로 모니터링하고 현재 라이브 상태를 원하는 목표 상태(Git repo에 명시된 바와 같이)와 비교하는 Kubernetes 컨트롤러로 구현된다.
라이브 상태가 대상 상태로부터 벗어나는 배포된 애플리케이션 OutOfSync. Argo CD reports & 시각화하면서 라이브 상태를 원하는 대상 상태로 자동 또는 수동으로 동기화할 수 있는 기능을 제공한다. 
Git repo에서 원하는 목표 상태에 대한 수정은 자동으로 적용되고 지정된 목표 환경에 반영될 수 있다.
![arch](https://argo-cd.readthedocs.io/en/stable/assets/argocd_architecture.png)

## 구성요소
### API 서버
API 서버는 웹 UI, CLI, CI/CD 시스템에서 사용하는 API를 노출하는 gRPC/REST 서버다. 다음과 같은 책임을 진다.

- 애플리케이션 관리 및 상태 보고
- 애플리케이션 작업 호출(예: 동기화, 롤백, 사용자 정의 작업)
- 리포지토리 및 클러스터 자격 증명 관리(K8s 기밀로 저장됨)
- 외부 ID 제공자에 대한 인증 및 인증 위임
- RBAC 시행
- Git Webhook 이벤트용 수신기/포워더

### 리포지토리 서버
리포지토리 서버는 애플리케이션 매니페스트를 보유하는 Git 리포지토리의 로컬 캐시를 관리하는 내부 서비스다. 그것은 다음과 같은 입력을 제공할 때 쿠베르네즈 매니페스트를 생성하고 반환할 책임이 있다.

- 리포지토리 URL
- 개정(커밋, 태그, 분기)
- 응용 프로그램 경로
- 템플릿별 설정: 매개 변수, ksonnet 환경, 조타 값.csl

### 애플리케이션 컨트롤러
애플리케이션 컨트롤러는 실행 중인 애플리케이션을 지속적으로 모니터링하고 현재 라이브 상태를 원하는 목표 상태(repo에 지정된 대로)와 비교하는 쿠베르네츠 컨트롤러다. 
그것은 감지한다. OutOfSync 적용 상태 및 선택적으로 시정 조치를 취한다. 
라이프사이클 이벤트(PreSync, Sync, PostSync)에 대해 사용자 정의 후크를 호출할 책임이 있다.